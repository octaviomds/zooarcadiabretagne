{"version":3,"sources":["../sdk/scripts/buildfire/components/control/tagsInput/tagsInput.js"],"names":["buildfire","components","control","Tagify","document","write","tagsInput","constructor","selector","data","this","_readyToFireEvent","_tagifyTags","activeTags","container","_source","settings","source","_sourceType","i","length","_validateSource","Error","sourceType","allowAutoComplete","allowUserInput","languageSettings","placeholder","_init","item","value","_container","querySelector","_buildComponent","_tagify","input","tagifyOptions","whitelist","autoComplete","enabled","rightKey","enforceWhitelist","userInput","on","_onAddRemoveTag","innerHTML","_addButton","addEventListener","set","items","_input","map","tag","onUpdate","tags","append","_tags","Array","isArray","push","addTags","clear","removeAllTags","get","event","userTagsInput","super","options","callback","auth","showTagsSearchDialog","err","result","console","error","_currentTags","allTags","tagName","j","splice"],"mappings":"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","file":"tagsInput.min.js","sourcesContent":["if (typeof buildfire == 'undefined')\n\tthrow 'please add buildfire.js first to use buildfire components';\nif (typeof buildfire.components == 'undefined') buildfire.components = {};\nif (typeof buildfire.components.control == 'undefined') buildfire.components.control = {};\n\nif (typeof Tagify == 'undefined') {\n\tdocument.write('<script src=\"' + '../../../../scripts/tagify/tagify.min.js\"></script>');\n\tdocument.write('<script src=\"' + '../../../../scripts/tagify/tagify.polyfills.min.js\"></script>');\n}\n\nbuildfire.components.control.tagsInput = class TagsInput {\n\n\tconstructor(selector, data = {}) {\n\t\t// tags arrays\n\t\tthis._readyToFireEvent = true;\n\t\tthis._tagifyTags = null;\n\t\tthis.activeTags = [];\n\t\tthis.container = null;\n\t\tthis.selector = selector || null;\n\n\t\tlet _source = data.settings?.source ? data.settings.source : [];\n\t\tlet _sourceType = 'list';\n\t\tif (typeof _source === \"function\") {\n\t\t\t_sourceType = 'custom';\n\t\t} else {\n\t\t\t//validate the list\n\t\t\tfor (let i = 0; i < _source.length; i++) {\n\t\t\t\tif (!this._validateSource(_source[i])) {\n\t\t\t\t\tthrow Error('Invalid source, missing value');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.settings = {\n\t\t\tsource: _source,\n\t\t\tsourceType: _sourceType,\n\t\t\tallowAutoComplete: typeof (data.settings?.allowAutoComplete) === 'undefined' ? true : data.settings.allowAutoComplete,\n\t\t\tallowUserInput: typeof (data.settings?.allowUserInput) === 'undefined' ? true : data.settings.allowUserInput,\n\t\t}\n\t\t// languageSettings = strings\n\t\tthis.languageSettings = {\n\t\t\tplaceholder: data.languageSettings?.placeholder || \"Select Tags\",\n\t\t}\n\t\tthis._init();\n\t}\n\n\t_validateSource(item) {\n\t\tif (item && item.value && typeof (item.value) === \"string\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t_init() {\n\t\tlet _container = document.querySelector(this.selector);\n\t\tif (!_container) throw new Error('Element not found!');\n\t\telse {\n\t\t\tthis.container = _container;\n\t\t\tthis._buildComponent();\n\t\t}\n\t}\n\n\t_tagify(input) {\n\t\tconst tagifyOptions = {\n\t\t\twhitelist: this.settings.sourceType === 'list' ? this.settings.source : [],\n\t\t\tautoComplete: {\n\t\t\t\tenabled: this.settings.allowAutoComplete,\n\t\t\t\trightKey: this.settings.allowAutoComplete\n\t\t\t},\n\t\t\tenforceWhitelist: false,\n\t\t\tuserInput: this.settings.allowUserInput\n\t\t}\n\n\t\tthis._tagifyTags = new Tagify(input, tagifyOptions);\n\n\t\tthis._tagifyTags.on('remove', () => this._onAddRemoveTag());\n\t\tthis._tagifyTags.on('change', () => this._onAddRemoveTag());\n\t}\n\n\t_buildComponent() {\n\t\tif (this.settings.sourceType === 'list')\n\t\t\tthis.container.innerHTML = `<input type=\"text\" class=\"form-control\" placeholder=\"${this.languageSettings.placeholder}\" >`\n\t\telse {\n\t\t\tthis.container.innerHTML = `\n            <div class=\"input-group\">\n                <input type=\"text\" class=\"form-control tagify_input_hide_courser\" placeholder=\"${this.languageSettings.placeholder}\" >\n                <span class=\"input-group-addon icon icon-plus add_tagBtn\"></span>\n            </div>`\n\n\t\t\tlet _addButton = this.container.querySelector('span');\n\t\t\t_addButton.addEventListener('click', () => {\n\t\t\t\tthis.settings.source({}, (items) => {\n\t\t\t\t\tthis.set(items);\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\n\t\tlet _input = this.container.querySelector('input');\n\n\t\tthis._tagify(_input);\n\t}\n\n\t_onAddRemoveTag() {\n\t\tthis.activeTags = (this._tagifyTags.value.length) ? this._tagifyTags.value.map(tag => {\n\t\t\treturn tag;\n\t\t}) : [];\n\n\t\tif (this._readyToFireEvent) {\n\t\t\tthis.onUpdate({tags: this.activeTags});\n\t\t}\n\t}\n\n\t// methods\n\tappend(data) {\n\t\tlet _tags = [];\n\t\tif (data && Array.isArray(data)) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tif (this._validateSource(data[i])) {\n\t\t\t\t\t_tags.push(data[i]);\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error('Invalid data, missing value');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._validateSource(data)) {\n\t\t\t\t_tags.push(data);\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid data, missing value');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < _tags.length; i++) {\n\t\t\tthis.activeTags.push(_tags[i]);\n\t\t}\n\t\tthis._tagifyTags.addTags(_tags);\n\t}\n\n\tclear() {\n\t\tthis.activeTags = [];\n\t\tthis._tagifyTags.removeAllTags();\n\t}\n\n\tset(data) {\n\t\tthis._readyToFireEvent = false;\n\t\tthis.activeTags = [];\n\t\tthis._tagifyTags.removeAllTags();\n\t\tthis._readyToFireEvent = true;\n\t\tthis.append(data);\n\t}\n\n\tget() {\n\t\treturn this.activeTags;\n\t}\n\n\t// events && handlers\n\tonUpdate(event) {\n\t\tthrow new Error('function not implemented');\n\t}\n}\n\nbuildfire.components.control.userTagsInput = class UserTagsInput extends buildfire.components.control.tagsInput {\n\n\tconstructor(selector, data = {}) {\n\n\t\tlet _data = {\n\t\t\tsettings: {\n\t\t\t\tsource: (options, callback) => {\n\t\t\t\t\tbuildfire.auth.showTagsSearchDialog(null, (err, result) => {\n\t\t\t\t\t\tif (err) return console.error(err);\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\tlet _currentTags = this.get();\n\t\t\t\t\t\t\tlet allTags = [...result, ..._currentTags];\n\t\t\t\t\t\t\t// since tagify require value property, we are appending it and we are removing it from exposed method when returning the value \"get, onUpdate\"\n\t\t\t\t\t\t\tallTags = allTags.map(tag => ({...tag, value: tag.tagName}));\n\n\t\t\t\t\t\t\t// remove repeat tags\n\t\t\t\t\t\t\tfor (let i = 0; i < allTags.length; i++) {\n\t\t\t\t\t\t\t\tfor (let j = i + 1; j < allTags.length; j++) {\n\t\t\t\t\t\t\t\t\tif (allTags[i].value === allTags[j].value) {\n\t\t\t\t\t\t\t\t\t\tallTags.splice(j, 1);\n\t\t\t\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcallback(allTags);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tallowAutoComplete: false,\n\t\t\t\tallowUserInput: false\n\t\t\t},\n\t\t\tlanguageSettings: data.languageSettings,\n\t\t}\n\t\tsuper(selector, _data);\n\t}\n}\n"]}